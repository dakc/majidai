// https://github.com/dakc/merodb
var MeroDB = function (t) { var e = {}; function n(r) { if (e[r]) return e[r].exports; var o = e[r] = { i: r, l: !1, exports: {} }; return t[r].call(o.exports, o, o.exports, n), o.l = !0, o.exports } return n.m = t, n.c = e, n.d = function (t, e, r) { n.o(t, e) || Object.defineProperty(t, e, { enumerable: !0, get: r }) }, n.r = function (t) { "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(t, Symbol.toStringTag, { value: "Module" }), Object.defineProperty(t, "__esModule", { value: !0 }) }, n.t = function (t, e) { if (1 & e && (t = n(t)), 8 & e) return t; if (4 & e && "object" == typeof t && t && t.__esModule) return t; var r = Object.create(null); if (n.r(r), Object.defineProperty(r, "default", { enumerable: !0, value: t }), 2 & e && "string" != typeof t) for (var o in t) n.d(r, o, function (e) { return t[e] }.bind(null, o)); return r }, n.n = function (t) { var e = t && t.__esModule ? function () { return t.default } : function () { return t }; return n.d(e, "a", e), e }, n.o = function (t, e) { return Object.prototype.hasOwnProperty.call(t, e) }, n.p = "", n(n.s = 0) }([function (t, e, n) { "use strict"; function r(t) { return (r = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (t) { return typeof t } : function (t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t })(t) } function o(t, e) { for (var n = 0; n < e.length; n++){ var r = e[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(t, r.key, r) } } function i(t, e) { return !e || "object" !== r(e) && "function" != typeof e ? function (t) { if (void 0 === t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return t }(t) : e } function c(t) { return (c = Object.setPrototypeOf ? Object.getPrototypeOf : function (t) { return t.__proto__ || Object.getPrototypeOf(t) })(t) } function l(t, e) { return (l = Object.setPrototypeOf || function (t, e) { return t.__proto__ = e, t })(t, e) } var u = n(1), s = function (t) { function e() { return function (t, e) { if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function") }(this, e), i(this, c(e).call(this)) } var n, s, f; return function (t, e) { if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), e && l(t, e) }(e, u), n = e, (s = [{ key: "loadFromJsonObject", value: function (t, e) { return "string" == typeof t && t.trim() ? "object" === r(e) && Array.isArray(e) ? (this.clcn[t] = e, !0) : (this.err = "arrayObj should be array of object.", !1) : (this.err = "collection name is not set", !1) } }, { key: "createCollection", value: function (t) { var e = arguments.length > 1 && void 0 !== arguments[1] && arguments[1]; return "string" != typeof t ? (this.err = "Collection name should be string.", !1) : t.trim() ? "boolean" != typeof e ? (this.err = "Second parameter should be boolean.", !1) : Object.prototype.hasOwnProperty.call(this.clcn, t) ? (this.err = "Collection name 「".concat(t, "」 already exists."), !1) : (this.clcn[t] = [], !e || this.use(t)) : (this.err = "Collection name should not be empty string.", !1) } }, { key: "use", value: function (t) { return "string" != typeof t ? (this.err = "Collection name should be string.", !1) : t.trim() ? Object.prototype.hasOwnProperty.call(this.clcn, t) ? (this.aClcn = t, !0) : (this.err = "No any collection found with name 「".concat(t, "」."), !1) : (this.err = "Collection name should not be empty string.", !1) } }, { key: "find", value: function () { for (var t = arguments.length, e = new Array(t), n = 0; n < t; n++)e[n] = arguments[n]; if (e.length > 3) return null; if (3 === e.length && "string" == typeof e[0] && "object" == r(e[1]) && "object" == r(e[2])) { if (!Array.isArray(e[2])) return null; var o = this._exec(this._find, [e[0], e[1]]), i = JSON.parse(JSON.stringify(o)); return i.forEach(function (t) { Object.keys(t).forEach(function (n) { e[2].includes(n) || delete t[n] }) }), i } if (2 === e.length && "object" == r(e[0]) && "object" == r(e[1])) { if (!Array.isArray(e[1])) return null; var c = this._exec(this._find, [e[0]]), l = JSON.parse(JSON.stringify(c)); return l.forEach(function (t) { Object.keys(t).forEach(function (n) { e[1].includes(n) || delete t[n] }) }), l } return 2 === e.length && "string" == typeof e[0] && "object" == r(e[1]) ? this._exec(this._find, e) : 1 === e.length && "object" == r(e[0]) ? this._exec(this._find, e) : null } }, { key: "update", value: function () { return 2 === arguments.length && "object" == r(arguments.length <= 0 ? void 0 : arguments[0]) && "object" == r(arguments.length <= 1 ? void 0 : arguments[1]) && "" !== this.aClcn ? this._update(this.aClcn, arguments.length <= 0 ? void 0 : arguments[0], arguments.length <= 1 ? void 0 : arguments[1]) : 3 === arguments.length && "string" == typeof (arguments.length <= 0 ? void 0 : arguments[0]) && "object" == r(arguments.length <= 1 ? void 0 : arguments[1]) && "object" == r(arguments.length <= 2 ? void 0 : arguments[2]) && this._update(arguments.length <= 0 ? void 0 : arguments[0], arguments.length <= 1 ? void 0 : arguments[1], arguments.length <= 2 ? void 0 : arguments[2]) } }, { key: "insert", value: function () { return !(arguments.length > 2 || 0 == arguments.length) && (2 === arguments.length ? !("string" != typeof (arguments.length <= 0 ? void 0 : arguments[0]) || "object" != r(arguments.length <= 1 ? void 0 : arguments[1]) || !Object.prototype.hasOwnProperty.call(this.clcn, arguments.length <= 0 ? void 0 : arguments[0])) && (this._insert(arguments.length <= 0 ? void 0 : arguments[0], arguments.length <= 1 ? void 0 : arguments[1]), !0) : 1 === arguments.length && ("object" == r(arguments.length <= 0 ? void 0 : arguments[0]) && "" !== this.aClcn && (this._insert(this.aClcn, arguments.length <= 0 ? void 0 : arguments[0]), !0))) } }, { key: "delete", value: function () { return !(arguments.length > 2 || 0 == arguments.length) && (2 === arguments.length ? !("string" != typeof (arguments.length <= 0 ? void 0 : arguments[0]) || "object" != r(arguments.length <= 1 ? void 0 : arguments[1]) || !Object.prototype.hasOwnProperty.call(this.clcn, arguments.length <= 0 ? void 0 : arguments[0])) && (this._delete(arguments.length <= 0 ? void 0 : arguments[0], arguments.length <= 1 ? void 0 : arguments[1]), !0) : 1 === arguments.length && ("object" == r(arguments.length <= 0 ? void 0 : arguments[0]) && "" !== this.aClcn && (this._delete(this.aClcn, arguments.length <= 0 ? void 0 : arguments[0]), !0))) } }, { key: "collAffected", value: function () { return this.num } }, { key: "getActiveCollection", value: function () { return this.aClcn } }, { key: "getError", value: function () { return this.err } }, { key: "getCollections", value: function () { return Object.keys(this.clcn) } }]) && o(n.prototype, s), f && o(n, f), e }(); t.exports = s }, function (t, e, n) { "use strict"; function r(t) { return (r = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (t) { return typeof t } : function (t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t })(t) } function o(t, e) { for (var n = 0; n < e.length; n++){ var r = e[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(t, r.key, r) } } var i = function () { function t() { !function (t, e) { if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function") }(this, t), this.clcn = Object.create(null), this.err = "", this.aClcn = "", this.num = 0 } var e, n, i; return e = t, (n = [{ key: "_isSatisfied", value: function (t, e) { if ("object" != r(t)) return !1; if ("object" != r(e)) return !1; if (1 !== Object.keys(e).length) return !1; var n = Object.keys(e)[0], o = e[n]; if ("object" != r(o)) return !1; var i = !1, c = Object.keys(o)[0]; return Object.keys(t).forEach(function (e) { if (n == e) return l = c, u = t[n], s = o[c], i = "$e" == l ? u === s : "$ne" == l ? u != s : "$lt" == l ? u < s : "$lte" == l ? u <= s : "$gt" == l ? u > s : "$gte" == l ? u >= s : "$cont" == l ? u.includes(s) : "$bt" == l && "object" == r(s) && !!Array.isArray(s) && 2 === s.length && (u >= s[0] && u <= s[1] || u >= s[1] && u <= s[0]); var l, u, s }), i } }, { key: "_find", value: function (t, e) { var n = this; if (this.err = "", !Object.prototype.hasOwnProperty.call(this.clcn, t)) return null; var o = this.clcn[t]; return Object.keys(e).forEach(function (t) { t.toString().startsWith("$or") && Array.isArray(e[t]) && (o = o.filter(function (o, i, c) { var l = !1; return e[t].forEach(function (t) { Object.keys(t).forEach(function (e) { return "object" != r(t[e]) && o[e] == t[e] ? l = !0 : "object" == r(t[e]) && n._isSatisfied(o, t, e) ? l = !0 : void 0 }) }), l })) }), Object.keys(e).forEach(function (t) { t.startsWith("$or") || (o = o.filter(function (o) { if ("object" != r(e[t]) && o[t] == e[t]) return !0; if ("object" == r(e[t])) { var i = Object.create({}); return Object.defineProperty(i, t, { value: e[t], enumerable: !0 }), n._isSatisfied(o, i) } return !1 })) }), o } }, { key: "_insert", value: function (t, e) { this.clcn[t].push(e) } }, { key: "_update", value: function (t, e, n) { if (this.err = "", this.num = 0, !Object.prototype.hasOwnProperty.call(this.clcn, t)) return !1; if ("$set" == Object.keys(n)[0]) { if ("object" !== r(n.$set)) return !1 } else if ("object" !== r(n)) return !1; var o = this._find(t, e); return !!(this.num = o.length) && ("$set" == Object.keys(n)[0] ? Object.keys(n.$set).forEach(function (t) { o.forEach(function (e) { Object.prototype.hasOwnProperty.call(e, t) && (e[t] = n.$set[t]) }) }) : o.forEach(function (t) { Object.keys(t).forEach(function (e) { delete t[e] }), Object.keys(n).forEach(function (e) { t[e] = n[e] }) }), !0) } }, { key: "_delete", value: function (t, e) { if (this.err = "", this.num = 0, !Object.prototype.hasOwnProperty.call(this.clcn, t)) return !1; if ("object" !== r(e)) return !1; var n = this._find(t, e); if (!(this.num = n.length)) return !1; var o = []; this.clcn[t].forEach(function (t, e) { n.forEach(function (n) { var r = 0; Object.keys(n).forEach(function (e) { n[e] == t[e] && r++ }), r == Object.keys(t).length && o.push(e) }) }); for (var i = o.length; i > 0; i--)this.clcn[t].splice(o[i - 1], 1); return !0 } }, { key: "_exec", value: function (t, e) { if (1 === e.length && ("object" == r(e[0]) && "" !== this.aClcn)) return t.bind(this, this.aClcn, e[0])(); if (2 === e.length && ("string" == typeof e[0] && "object" == r(e[1]))) return t.bind(this, e[0], e[1])(); return !1 } }]) && o(e.prototype, n), i && o(e, i), t }(); t.exports = i }]);

module.exports = MeroDB;